# CSP Provider

<Subtitle>Configures CSP-related behavior for inline tags rendered by Base UI components.</Subtitle>
<Meta
  name="description"
  content="A CSP provider component that applies a nonce to inline <style> and <script> tags rendered by Base UI components, and can disable inline <style> elements."
/>

## Anatomy

Import the component and wrap it around your app:

```jsx title="Anatomy"
import { CSPProvider } from '@base-ui/react/csp-provider';

// prettier-ignore
<CSPProvider nonce="...">
  {/* Your app or a group of components */}
</CSPProvider>
```

Some Base UI components render inline `<style>` or `<script>` tags for functionality such as removing scrollbars or pre-hydration behavior. Under a strict Content Security Policy (CSP), these tags may be blocked unless they include a matching [nonce](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Global_attributes/nonce) attribute.

`CSPProvider` supplies that `nonce` value to all supported components automatically.

## Disable inline `<style>` elements

If you want to avoid rendering inline `<style>` elements entirely (for example, to rely on external stylesheets only) without needing to specify `nonce`, specify `disableStyleElements`:

```jsx title="Disabling style elements"
<CSPProvider disableStyleElements>{/* ... */}</CSPProvider>
```

`<script>` tags cannot be disabled, as they are required for pre-hydration behavior and require a nonce instead.

## Content Security Policy (CSP)

If you enforce a CSP that blocks inline tags by default, configure your server to:

1. Generate a random nonce per request
2. Include it in your CSP header (via `style-src-elem`/`script-src`)
3. Pass the same nonce into `CSPProvider` during rendering

```ts title="Example"
const nonce = crypto.randomUUID();

// Example CSP header
const csp = [
  `default-src 'self'`,
  `script-src 'self' 'nonce-${nonce}'`,
  `style-src-elem 'self' 'nonce-${nonce}'`,
].join('; ');
```

Then:

```jsx title="Providing the nonce"
import { CSPProvider } from '@base-ui/react/csp-provider';

function App({ nonce }) {
  return <CSPProvider nonce={nonce}>{/* ... */}</CSPProvider>;
}
```

## Inline style attributes

`CSPProvider` covers inline `<style>` and `<script>` tags rendered as elements, but it does not cover inline style attributes (for example, `<div style="...">`).

In CSP:

- `style-src` applies to both `<style>` elements and `style=""` attributes.
- If you only want to control `<style>` elements, use `style-src-elem` instead.
- If you specifically want to control `style=""` attributes, use `style-src-attr`.

If your CSP blocks inline style attributes, you have a few options:

1. Relax your CSP by adding `'unsafe-inline'` to the `style-src-attr` directive (or using only `style-src-elem` instead of `style-src`). Style attributes specifically pose a less severe security risk than style elements, but this approach may not be acceptable in high-security environments.
2. Render the affected components only on the client, so that no inline styles are present in the initial HTML.
3. Manually unset inline styles and specify them in your CSS instead. Any component can have its inline styles unset, such as `<ScrollArea.Viewport style={{ overflow: undefined  }}>`. Note that you'll need to ensure you vet upgrades for any new inline styles added by Base UI components.

## API reference

<Reference component="CSPProvider" />

## useCSPContext

Use this hook to read the current CSP configuration (for example, to apply a nonce to your own inline tags).

### Return value

<PropsReferenceTable
  type="return"
  data={{
    nonce: {
      type: 'string',
      detailedType: 'string | undefined',
      description: 'The current nonce value.',
    },
    disableStyleElements: {
      type: 'boolean',
      detailedType: 'boolean',
      description: 'Whether inline `<style>` elements are disabled.',
    },
  }}
/>

export const metadata = {
  keywords: [
    'Base UI CSP Provider',
    'Content Security Policy',
    'CSP nonce',
    'React CSP',
    'Inline script nonce',
    'Inline style nonce',
  ],
};
